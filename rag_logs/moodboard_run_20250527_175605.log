2025-05-27 17:56:05,140 - INFO     - __main__                       - Logging initialized. Console: INFO, File: DEBUG -> /home/raduc/Documents/Code/Licentzio/MusicBlock/rag_logs/moodboard_run_20250527_175605.log
2025-05-27 17:56:13,985 - INFO     - sentence_transformers.SentenceTransformer - Load pretrained SentenceTransformer: BAAI/bge-base-en-v1.5
2025-05-27 17:56:13,988 - DEBUG    - urllib3.connectionpool         - Starting new HTTPS connection (1): huggingface.co:443
2025-05-27 17:56:14,319 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/modules.json HTTP/1.1" 200 0
2025-05-27 17:56:14,796 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-05-27 17:56:15,003 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/README.md HTTP/1.1" 200 0
2025-05-27 17:56:15,175 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/modules.json HTTP/1.1" 200 0
2025-05-27 17:56:15,411 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-05-27 17:56:15,616 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/adapter_config.json HTTP/1.1" 404 0
2025-05-27 17:56:15,821 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/config.json HTTP/1.1" 200 0
2025-05-27 17:56:16,844 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "HEAD /BAAI/bge-base-en-v1.5/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-05-27 17:56:17,153 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "GET /api/models/BAAI/bge-base-en-v1.5/revision/main HTTP/1.1" 200 148868
2025-05-27 17:56:17,563 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "GET /api/models/BAAI/bge-base-en-v1.5 HTTP/1.1" 200 148868
2025-05-27 17:56:17,869 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "GET /api/models/Qdrant/bm25 HTTP/1.1" 200 2136
2025-05-27 17:56:18,073 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "GET /api/models/Qdrant/bm25/tree/e499a1f8d6bec960aab5533a0941bf914e70faf9?recursive=False&expand=False HTTP/1.1" 200 3229
2025-05-27 17:56:18,280 - DEBUG    - urllib3.connectionpool         - https://huggingface.co:443 "GET /api/models/Qdrant/bm25/revision/main HTTP/1.1" 200 2136
2025-05-27 17:56:18,817 - INFO     - rag_agent_nodes                - LLM initialized: Model=meta-llama/Llama-3.2-3B-Instruct, Base=https://api.runpod.ai/v2/u4d3b5g2c5ot09/openai/v1
2025-05-27 17:56:18,817 - INFO     - __main__                       - RAG Music Moodboard Script Started (after local module imports).
2025-05-27 17:56:18,817 - INFO     - __main__                       - Using LLM: meta-llama/Llama-3.2-3B-Instruct (Status from agent_nodes: INITIALIZED)
2025-05-27 17:56:18,818 - INFO     - __main__                       - Setting CONSOLE log level to DEBUG due to --debugconsole flag.
2025-05-27 17:56:18,818 - INFO     - __main__                       - Console log level set to DEBUG.
2025-05-27 17:56:18,818 - INFO     - __main__                       - --- New Moodboard Generation Run ---
2025-05-27 17:56:18,818 - INFO     - __main__                       - Execution Mode: CONCURRENT
2025-05-27 17:56:18,819 - INFO     - __main__                       - Building graph: Adding nodes...
2025-05-27 17:56:18,820 - INFO     - __main__                       - Building graph: Entry point set to 'initial_processor'.
2025-05-27 17:56:18,821 - INFO     - __main__                       - Building graph: Using CONCURRENT agent execution flow.
2025-05-27 17:56:18,821 - INFO     - __main__                       - Building graph: Final edge to END set from 'advice_combiner'.
2025-05-27 17:56:18,829 - INFO     - __main__                       - LangGraph RAG Moodboard Generator Compiled.
2025-05-27 17:56:30,270 - INFO     - __main__                       - User Text Query: Country rock
2025-05-27 17:57:02,901 - INFO     - __main__                       - No audio file provided by user.
2025-05-27 17:57:02,903 - INFO     - __main__                       - Similarity Summary (Placeholder) Snippet:
No audio was provided for similarity analysis. For general context, here are some diverse example tracks:

| #  | Title                | Artist                          | Key       | BPM | Genres     ...
2025-05-27 17:57:02,903 - INFO     - __main__                       - Initial graph state prepared (keys only): ['user_text_query', 'user_audio_path', 'user_audio_features', 'similar_tracks_summary', 'project_goal_summary', 'rhythm_advice', 'rhythm_kb_sources', 'rhythm_stack_sources', 'music_theory_advice', 'music_theory_kb_sources', 'music_theory_stack_sources', 'instruments_advice', 'instruments_kb_sources', 'instruments_stack_sources', 'lyrics_advice', 'lyrics_kb_sources', 'lyrics_stack_sources', 'production_advice', 'production_kb_sources', 'production_stack_sources', 'final_moodboard', 'error_message', 'should_run_lyrics_agent', 'all_accumulated_sources', 'node_prompt_tokens', 'node_completion_tokens', 'rhythm_se_query_prompt_tokens', 'rhythm_se_query_completion_tokens', 'music_theory_se_query_prompt_tokens', 'music_theory_se_query_completion_tokens', 'instruments_se_query_prompt_tokens', 'instruments_se_query_completion_tokens', 'lyrics_se_query_prompt_tokens', 'lyrics_se_query_completion_tokens', 'production_se_query_prompt_tokens', 'production_se_query_completion_tokens', 'rhythm_final_advice_prompt_tokens', 'rhythm_final_advice_completion_tokens', 'music_theory_final_advice_prompt_tokens', 'music_theory_final_advice_completion_tokens', 'instruments_final_advice_prompt_tokens', 'instruments_final_advice_completion_tokens', 'lyrics_final_advice_prompt_tokens', 'lyrics_final_advice_completion_tokens', 'production_final_advice_prompt_tokens', 'production_final_advice_completion_tokens', 'total_prompt_tokens', 'total_completion_tokens', 'total_cost']
2025-05-27 17:57:02,903 - INFO     - __main__                       - Invoking LangGraph workflow...
2025-05-27 17:57:02,908 - INFO     - rag_agent_nodes                - --- NODE START: Initial Input Processor ---
2025-05-27 17:57:02,908 - INFO     - rag_agent_nodes                - User Query: 'Country rock'
2025-05-27 17:57:02,913 - DEBUG    - openai._base_client            - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-455994c1-bcc9-484d-97a5-bf4ed360d0d5', 'json_data': {'messages': [{'content': "\nYou are a helpful assistant that synthesizes information for a music creation project.\nBased on the user's request and an analysis of similar music (if provided), create a concise project goal summary.\nThis summary will guide other specialized AI agents in providing creative advice.\nFocus on extracting key musical elements: genre, target artists/style, mood, instrumentation, tempo, and key signatures mentioned or implied.\nKeep the summary to 1-2 concise paragraphs.\n\nUser Request:\n---\nCountry rock\n---\n\nProvided Similarity Analysis (characteristics of the user's audio or comparable tracks):\n---\nNo audio was provided for similarity analysis. For general context, here are some diverse example tracks:\n\n| #  | Title                | Artist                          | Key       | BPM | Genres                      | Other tags                          |\n| -- | -------------------- | ------------------------------- | --------- | --- | --------------------------- | ----------------------------------- |\n| 1  | Serge's Kiss         | Daybehavior                     | C minor   | 109 | alternative rock, dream pop | re-recording, pop, alternative rock |\n| 2  | Imagine              | John Lennon                     | C major   | 75  | rock, pop                   | piano, classic, 1971                |\n| 3  | Billie Jean          | Michael Jackson                 | F ♯ minor | 117 | pop, R&B                    | dance, 1980s, synth                 |\n| 4  | Smells Like Teen…    | Nirvana                         | F minor   | 117 | grunge, alternative rock    | 1990s, guitar riff, breakthrough    |\n| 5  | Rolling in the Deep  | Adele                           | C minor   | 105 | pop, soul                   | powerful vocals, 2010s              |\n| 6  | Take Five            | The Dave Brubeck Quartet        | E ♭ minor | 174 | jazz, cool jazz             | saxophone, classic, instrumental    |\n| 7  | Get Lucky            | Daft Punk ft. Pharrell Williams | F minor   | 116 | disco, electronic, funk     | dancefloor, 2010s                   |\n| 8  | Nothing Else Matters | Metallica                       | E minor   | 142 | heavy metal, rock           | ballad, acoustic intro              |\n| 9  | Bad Guy              | Billie Eilish                   | G minor   | 135 | pop, electro-pop            | whisper vocals, modern sound        |\n| 10 | Clocks               | Coldplay                        | E ♭ major | 131 | alternative rock, pop rock  | piano riff, 2000s                   |\n\n(Note: These are general examples, not based on specific audio input.)\n---\n\nConcise Project Goal Summary:\n", 'role': 'user'}], 'model': 'meta-llama/Llama-3.2-3B-Instruct', 'stream': False, 'temperature': 0.7}}
2025-05-27 17:57:02,918 - DEBUG    - openai._base_client            - Sending HTTP Request: POST https://api.runpod.ai/v2/u4d3b5g2c5ot09/openai/v1/chat/completions
2025-05-27 17:57:02,919 - DEBUG    - httpcore.connection            - connect_tcp.started host='api.runpod.ai' port=443 local_address=None timeout=300.0 socket_options=None
2025-05-27 17:57:02,988 - DEBUG    - httpcore.connection            - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f6edd264460>
2025-05-27 17:57:02,989 - DEBUG    - httpcore.connection            - start_tls.started ssl_context=<ssl.SSLContext object at 0x7f6e979d9440> server_hostname='api.runpod.ai' timeout=300.0
2025-05-27 17:57:03,029 - DEBUG    - httpcore.connection            - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x7f6edd2642b0>
2025-05-27 17:57:03,029 - DEBUG    - httpcore.http11                - send_request_headers.started request=<Request [b'POST']>
2025-05-27 17:57:03,030 - DEBUG    - httpcore.http11                - send_request_headers.complete
2025-05-27 17:57:03,030 - DEBUG    - httpcore.http11                - send_request_body.started request=<Request [b'POST']>
2025-05-27 17:57:03,030 - DEBUG    - httpcore.http11                - send_request_body.complete
2025-05-27 17:57:03,030 - DEBUG    - httpcore.http11                - receive_response_headers.started request=<Request [b'POST']>
2025-05-27 18:01:34,948 - DEBUG    - httpcore.http11                - receive_response_headers.failed exception=KeyboardInterrupt()
2025-05-27 18:01:34,951 - DEBUG    - httpcore.http11                - response_closed.started
2025-05-27 18:01:34,951 - DEBUG    - httpcore.http11                - response_closed.complete
